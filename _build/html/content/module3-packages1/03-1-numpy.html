
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. NumPy &#8212; Draft Python for Science Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=e52fa269" />
    <link rel="stylesheet" type="text/css" href="../../_static/.ipynb_checkpoints/custom-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/module3-packages1/03-1-numpy';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Pandas" href="03-2-pandas.html" />
    <link rel="prev" title="Module 3: Packages" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Draft Python for Science Book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Draft Python for Science Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Python for Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math-test.html">In a Markdown cell:</a></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../module1-setup/README.html">Module 1: Getting Set Up</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-1-setupcomputer.html">1. Setting up your computer</a></li>











<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-2-jynbgettingstarted.html">2: Runnng and Creating Jupyter Notebooks</a></li>









<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-3-jynb-intro.html">3. Overview of Jupyter Notebooks</a></li>





<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-4-oshardware.html">4. Computer Hardware Germane to Running a Program</a></li>



<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-5-git.html">5. Git and GitHub</a></li>













<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-6-oop.html">6. Object Oriented Programming</a></li>







<li class="toctree-l2"><a class="reference internal" href="../module1-setup/01-7-virtual-environments.html">7. Virtual Environments</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module2-oop-data-structures/README.html">Module 2: Data Structures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-1-primitive-data-structures.html">1. Primative Data Structures</a></li>







<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-2-py-calculator.html">2. Python as a Calculator</a></li>



<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-3-composite-data-structures.html">3. Composite Data Structures</a></li>







<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-4-built-in-modules.html">4. Built-In Modules</a></li>






<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-5-control-structures.html">5. Logic and Control Structures</a></li>





<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-6-external-data-structures.html">6. External Data Structures</a></li>










<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-7-db-external-data-structures.html">7. Databases as External Data Structures</a></li>





<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-8-api-external-data-structures.html">8. APIs as External Data Structures</a></li>





<li class="toctree-l2"><a class="reference internal" href="../module2-oop-data-structures/02-9-webscrape-external-data-structures.html">9. WebScraping as External Data Structures</a></li>


</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Module 3: Packages</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">1. NumPy</a></li>










<li class="toctree-l2"><a class="reference internal" href="03-2-pandas.html">2. Pandas</a></li>






<li class="toctree-l2"><a class="reference internal" href="03-3-xarray.html">3. Xarray</a></li>







<li class="toctree-l2"><a class="reference internal" href="03-4-matplotlib.html">4. MatPlotLib</a></li>









<li class="toctree-l2"><a class="reference internal" href="03-5-seaborn.html">5. Seaborn Part 1</a></li>




<li class="toctree-l2"><a class="reference internal" href="03-6-seaborn.html">7. Seaborn Part 2</a></li>


<li class="toctree-l2"><a class="reference internal" href="03-7-seaborn.html">7. Seaborn Part 3</a></li>


<li class="toctree-l2"><a class="reference internal" href="03-8-scipy.html">8. SciPy</a></li>





<li class="toctree-l2"><a class="reference internal" href="03-9-rdkit.html">9. RDKit</a></li>






<li class="toctree-l2"><a class="reference internal" href="03-10-rdkit-descriptors.html">10. RDKit and Descriptors</a></li>




</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/rebelford/py4scibook/master?urlpath=lab/tree/docs/content/module3-packages1/03-1-numpy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://your-jupyterhub-url.com/hub/user-redirect/git-pull?repo=https%3A//github.com/rebelford/py4scibook&urlpath=lab/tree/py4scibook/docs/content/module3-packages1/03-1-numpy.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/rebelford/py4scibook/blob/master/docs/content/module3-packages1/03-1-numpy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rebelford/py4scibook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rebelford/py4scibook/issues/new?title=Issue%20on%20page%20%2Fcontent/module3-packages1/03-1-numpy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/module3-packages1/03-1-numpy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. NumPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. NumPy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-an-array">1.1: Features of an Array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-dimensionality">1.2: Array Dimensionality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#array-axes">Array Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-array-example">4D array Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-properties">1.3 Array Properties</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays-as-a-python-objects">2. Arrays as a Python Objects</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-array-attributes">Table of NumPy Array Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-array-methods">Table of NumPy Array Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-functions-for-arrays">Table of NumPy Functions for Arrays</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#array-data-types">3. Array Data Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dtype">dtype()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#astype-changing-dtypes">.astype() -changing dtypes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-array-tasks">4. Basic Array Tasks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-arrays">4.1: Creating Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#array-constructor-np-array">Array constructor (np.array())</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-array">1D array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2D array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3D array</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-linespace">np.linespace()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-arange">np.arange()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-np-arange-vs-np-linspace">Comparison: np.arange() vs. np.linspace()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-zeros">np.zeros()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-ones">np.ones()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-indexing-introduction">4.2: Array Indexing (Introduction)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-a-single-value">Extracting a Single Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-1d-array">Extract a 1D array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-2d-array">Extract a 2D array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slice-out-the-first-experiment">Slice out the first experiment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slice-out-all-data-for-second-and-third-sample-times">Slice out all data for second and third sample times</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table">Summary Table</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-attributes">4.3: Array Attributes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shape">.shape</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ndim">.ndim</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#size">.size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays-from-functions-np-fromfunction">4.4: Arrays from Functions (np.fromfunction())</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-arrays">4.5: Sorting Arrays</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-arrays">4.6 Reshaping Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape">.reshape()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flatten">.flatten()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose-arrays">Transpose Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-full-transpose">.T (Full Transpose)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose">.transpose()</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-kinetic-absorbance-data-for-a-chemical-reaction">Scenario: Kinetic Absorbance Data for a Chemical Reaction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-arrays">4.7: Merging Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-vstack">np.vstack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-hstack">np.hstack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-column-stack">np.column_stack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-dstack">np.dstack( )</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-1d-arrays">Stacking 1D arrays</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-2d-arrays">Stacking 2D arrays</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-stack">np.stack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-concatenate">np.concatenate()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization-and-broadcasting-arrays">4.8: Vectorization and Broadcasting Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization">Vectorization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-math-on-arrays">Scalar math on arrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-io-saving-arrays">4.9 Array io (saving arrays)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-load-a-numpy-array">Save/Load a NumPy array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-load-multiple-arrays">Save/Load multiple arrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-number-generation">5. Random Number Generation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-random-module-with-np-random-submodule">Compare Random module with np.random submodule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-and-methods-in-numpy-random">Functions and Methods in <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-random-seed">np.random.seed()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-random-default-rng">np.random.default_rng()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uniform-distribution">Uniform Distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">6. Masks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonzero">.nonzero()</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-numpy-handles-true-boolean-masks"><strong>Why NumPy Handles True Boolean Masks</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where">.where</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data">8. Missing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ieee-nan-not-a-number">IEEE NaN (Not a Number)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-boolean-masks-for-nan">Using Boolean Masks for NaN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-statistics">9. NumPy Statistics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-nan-statistics">10. Numpy NaN Statistics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#other-numpy-datatypes">12. Other Numpy DataTypes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-arrays-np-array">9.1: Structured arrays (np.array)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-are-structured-arrays-different-from-regular-ndarrays">How Are Structured Arrays Different from Regular <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#masked-arrays-np-ma-array">9.2: Masked arrays (np.ma.array)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#record-arrays-np-recarray">9.3: Record Arrays (np.recarray)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="numpy">
<span id="module3-packages1-03-1-numpy"></span><h1>1. NumPy<a class="headerlink" href="#numpy" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p><strong>Numpy</strong> stands for <strong>Num</strong>erical <strong>py</strong>thon and it is typically imported as np</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
<p>The major data structure numpy provides is the array, or more accurately <strong>ndarray</strong>, and arrays can represent data in multiple Dimensions.  Section 9 of this tutorial goes over several other types of data structures but we will focus on the array.</p>
<section id="features-of-an-array">
<h2>1.1: Features of an Array<a class="headerlink" href="#features-of-an-array" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Homgeonous Data Type (Structured Arrays can have multiple data types but store data differently)</p></li>
<li><p>Once created size can not be changed</p></li>
<li><p>Must be rectangular</p></li>
</ul>
</section>
<section id="array-dimensionality">
<h2>1.2: Array Dimensionality<a class="headerlink" href="#array-dimensionality" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Dimension (Rank)</strong></p></th>
<th class="head"><p><strong>Common Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Example Shape (<code class="docutils literal notranslate"><span class="pre">.shape</span></code>)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>0D</strong></p></td>
<td><p>Scalar</p></td>
<td><p>A single numerical value, not an array but an atomic element.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">()</span></code> (empty tuple)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1D</strong></p></td>
<td><p>Vector</p></td>
<td><p>A one-dimensional array (list-like but with array properties).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(n,)</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">(5,)</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><strong>2D</strong></p></td>
<td><p>Matrix</p></td>
<td><p>A rectangular grid of numbers with rows and columns.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n)</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4)</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>3D</strong></p></td>
<td><p>Tensor</p></td>
<td><p>A stack of matrices, used in physics and deep learning.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">m,</span> <span class="pre">n)</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3,</span> <span class="pre">4)</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><strong>4D</strong></p></td>
<td><p>HyperTensor</p></td>
<td><p>Higher-order tensor, used in advanced machine learning.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(t,</span> <span class="pre">d,</span> <span class="pre">m,</span> <span class="pre">n)</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4)</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>nD</strong></p></td>
<td><p>nD Array (General)</p></td>
<td><p>An array with any number of dimensions (<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">≥</span> <span class="pre">0</span></code>).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(dim_1,</span> <span class="pre">dim_2,</span> <span class="pre">...,</span> <span class="pre">dim_n)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><br></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<section id="array-axes">
<h3>Array Axes<a class="headerlink" href="#array-axes" title="Link to this heading">#</a></h3>
<p>An axes is a dimension along which data is arranged in a NumPy array and you can think of it as an indexing direction that allows you to navigate and manipulate data.  Note, <strong>axis 0 is the highest ranked axes.</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Dimension (Rank)</strong></p></th>
<th class="head"><p><strong>Axes</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1D Array</strong></p></td>
<td><p>1 axis (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">0</span></code>)</p></td>
<td><p>Like a Python list: a single sequence of elements.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2D Array</strong></p></td>
<td><p>2 axes (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">0</span></code>: rows, <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">1</span></code>: columns)</p></td>
<td><p>Like a table (rows and columns).</p></td>
</tr>
<tr class="row-even"><td><p><strong>3D Array</strong></p></td>
<td><p>3 axes (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">0</span></code>: depth, <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">1</span></code>: rows, <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">2</span></code>: columns)</p></td>
<td><p>Like multiple stacked tables.</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<section id="d-array-example">
<h4>4D array Example<a class="headerlink" href="#d-array-example" title="Link to this heading">#</a></h4>
<p>Multiple experiments of the spectra of a reaction mixture where reactants concentrations are varied.<br></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Axis</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Role in Experiment</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Axis 0</strong></p></td>
<td><p>Experiment Number</p></td>
<td><p>Separate runs where reactant concentrations vary</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Axis 1</strong></p></td>
<td><p>Temporal Data Cube</p></td>
<td><p>Absorbance values at different times</p></td>
</tr>
<tr class="row-even"><td><p><strong>Axis 2</strong></p></td>
<td><p>Wavelength</p></td>
<td><p>Spectral dimension (e.g., 400-700 nm)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Axis 3</strong></p></td>
<td><p>Absorbance at Wavelength</p></td>
<td><p>Intensity values at each wavelength</p></td>
</tr>
</tbody>
</table>
</div>
<p><br>Since NumPy <strong>indexing follows axes</strong>, so you can retrieve meaningful slices from your data.</p>
<br>
</section>
</section>
</section>
<section id="array-properties">
<h2>1.3 Array Properties<a class="headerlink" href="#array-properties" title="Link to this heading">#</a></h2>
<p>Arrays use brackets like lists and in fact a 1D array looks like a list, but the array holds one block of memory while the list has pointers to multiple memory blocks.</p>
<ol class="arabic simple">
<li><p>Fixed Data Type (All elements of same data type)</p></li>
<li><p>Arrays are Mutable (You can change values within an array)</p></li>
<li><p>Fixed Size (Fixed upon creation)</p></li>
<li><p>Efficient Memory Usage (stores data in contiguous memory)</p></li>
<li><p>Vectorized Operations (supports element-wise operations that a list would require loops for)</p></li>
<li><p>Multi-Dimensional Support (Does not need nested structures like a list would)</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="arrays-as-a-python-objects">
<h1>2. Arrays as a Python Objects<a class="headerlink" href="#arrays-as-a-python-objects" title="Link to this heading">#</a></h1>
<section id="table-of-numpy-array-attributes">
<h2>Table of NumPy Array Attributes<a class="headerlink" href="#table-of-numpy-array-attributes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>Tuple of array dimensions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ndim</span></code></p></td>
<td><p>Number of array dimensions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">size</span></code></p></td>
<td><p>Total number of elements in the array</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p>Data type of the array elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">itemsize</span></code></p></td>
<td><p>Size in bytes of each array element</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
<td><p>Python buffer object pointing to the array’s data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">strides</span></code></p></td>
<td><p>Tuple of bytes to step in each dimension when traversing the array</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">flags</span></code></p></td>
<td><p>Information about the memory layout of the array</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">real</span></code></p></td>
<td><p>Real part of the array (for complex number arrays)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">imag</span></code></p></td>
<td><p>Imaginary part of the array (for complex number arrays)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="table-of-numpy-array-methods">
<h2>Table of NumPy Array Methods<a class="headerlink" href="#table-of-numpy-array-methods" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reshape()</span></code></p></td>
<td><p>Returns a new array with a changed shape</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">transpose()</span></code></p></td>
<td><p>Returns a new array with axes transposed</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></p></td>
<td><p>Returns a copy of the array collapsed into one dimension</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">astype()</span></code></p></td>
<td><p>Cast the array to a specified data type</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">copy()</span></code></p></td>
<td><p>Return a copy of the array</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fill()</span></code></p></td>
<td><p>Fill the array with a scalar value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sort()</span></code></p></td>
<td><p>Sort an array in-place</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max()</span></code></p></td>
<td><p>Return the maximum value along a given axis</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">min()</span></code></p></td>
<td><p>Return the minimum value along a given axis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code></p></td>
<td><p>Compute the arithmetic mean along the specified axis</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="table-of-numpy-functions-for-arrays">
<h2>Table of NumPy Functions for Arrays<a class="headerlink" href="#table-of-numpy-functions-for-arrays" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.array()</span></code></p></td>
<td><p>Create an array</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.zeros()</span></code></p></td>
<td><p>Create an array filled with zeros</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.ones()</span></code></p></td>
<td><p>Create an array filled with ones</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.arange()</span></code></p></td>
<td><p>Create an array with evenly spaced values within a given interval</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code></p></td>
<td><p>Create an array with evenly spaced numbers over a specified interval</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.concatenate()</span></code></p></td>
<td><p>Join arrays along an existing axis</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.vstack()</span></code></p></td>
<td><p>Stack arrays vertically (row-wise)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.hstack()</span></code></p></td>
<td><p>Stack arrays horizontally (column-wise)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.split()</span></code></p></td>
<td><p>Split an array into multiple sub-arrays</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.where()</span></code></p></td>
<td><p>Return elements chosen from two arrays depending on condition</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="array-data-types">
<h1>3. Array Data Types<a class="headerlink" href="#array-data-types" title="Link to this heading">#</a></h1>
<section id="dtype">
<h2>dtype()<a class="headerlink" href="#dtype" title="Link to this heading">#</a></h2>
<p>In python everything has a type, which you can find with the type() function.  In Numpy data also has a type function called dtype(), which like the type(), defines how much memory the object uses. The following table covers the common data types stored in a Numpy Array and it is often important to define these when creating an array.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Example Equivalent</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'b'</span></code></p></td>
<td><p>Boolean</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'i'</span></code></p></td>
<td><p>Integer (default)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int32</span></code>, <code class="docutils literal notranslate"><span class="pre">int64</span></code> (depends on system)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'L'</span></code></p></td>
<td><p>Long Integer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int64</span></code> (platform-dependent)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'u'</span></code></p></td>
<td><p>Unsigned Integer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint32</span></code>, <code class="docutils literal notranslate"><span class="pre">uint64</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'f'</span></code></p></td>
<td><p>Floating Point</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>, <code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'c'</span></code></p></td>
<td><p>Complex Float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code>, <code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'m'</span></code></p></td>
<td><p>Timedelta</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'M'</span></code></p></td>
<td><p>Datetime</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'O'</span></code></p></td>
<td><p>Object (Python objects)</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'S'</span></code> or <code class="docutils literal notranslate"><span class="pre">'a'</span></code></p></td>
<td><p>String (bytes)</p></td>
<td><p>Fixed-length strings</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'U'</span></code></p></td>
<td><p>Unicode String</p></td>
<td><p>Fixed-length Unicode</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="astype-changing-dtypes">
<h2>.astype() -changing dtypes<a class="headerlink" href="#astype-changing-dtypes" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Example array of long integers</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1733976600</span><span class="p">,</span> <span class="mi">1733798400</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>

<span class="c1"># Convert to float</span>
<span class="n">arr_float</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>  <span class="c1"># Convert to float64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Example array</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1733976600</span><span class="p">,</span> <span class="mi">1733798400</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>

<span class="c1"># Check dtype</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;memory location = </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># Convert to float</span>
<span class="n">arr_float</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>  <span class="c1"># Convert to float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_float</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;memory location = </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">arr_float</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1733976600 1733798400]
int64
memory location = 130959724447856

[1.7339766e+09 1.7337984e+09]
float64
memory location = 130958383798800
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="basic-array-tasks">
<h1>4. Basic Array Tasks<a class="headerlink" href="#basic-array-tasks" title="Link to this heading">#</a></h1>
<section id="creating-arrays">
<h2>4.1: Creating Arrays<a class="headerlink" href="#creating-arrays" title="Link to this heading">#</a></h2>
<p>Array syntax looks like a Python list for a 1D Array in that the elements are in square brackets and separated by commas.</p>
<section id="array-constructor-np-array">
<h3>Array constructor (np.array())<a class="headerlink" href="#array-constructor-np-array" title="Link to this heading">#</a></h3>
<p>Creating Arrays from other python objects. In this exercise we are going to use nested python lists to create an array with the array constructor <code class="docutils literal notranslate"><span class="pre">np.array()</span></code>.</p>
<p>note, an ndarray is of a single type of data, but you can use the np.array() constructor to make a <strong>structured array</strong>, which is an array with more than one data type (see section 9 below).</p>
<section id="d-array">
<h4>1D array<a class="headerlink" href="#d-array" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="n">my_1Darray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_1Darray</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_1Darray</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7, 8] is &lt;class &#39;list&#39;&gt;.
[1 2 3 4 5 6 7 8] is &lt;class &#39;numpy.ndarray&#39;&gt;.
</pre></div>
</div>
</div>
</div>
<p>Just as a loop an be nested inside of another loop, a list can be nested inside of another list</p>
</section>
<section id="id1">
<h4>2D array<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_2nested_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_2nested_list</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_2nested_list</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="n">my_2Darray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">my_2nested_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_2Darray</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_2Darray</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1, 2], [3, 4], [5, 6], [7, 8]] is &lt;class &#39;list&#39;&gt;.
[[1 2]
 [3 4]
 [5 6]
 [7 8]] is &lt;class &#39;numpy.ndarray&#39;&gt;.
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>3D array<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_3nested_list</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_3nested_list</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_3nested_list</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="n">my_3Darray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">my_3nested_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">my_3Darray</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_3Darray</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[1, 2], [3, 4]], [[5, 6], [7, 8]]] is &lt;class &#39;list&#39;&gt;.
[[[1 2]
  [3 4]]

 [[5 6]
  [7 8]]] is &lt;class &#39;numpy.ndarray&#39;&gt;.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="np-linespace">
<h3>np.linespace()<a class="headerlink" href="#np-linespace" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>generates evenly spaced numbers over a specified range.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start</span></code></p></td>
<td><p>The starting value of the sequence (inclusive).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">stop</span></code></p></td>
<td><p>The ending value of the sequence. By default, it is <strong>inclusive</strong>, but you can exclude it using <code class="docutils literal notranslate"><span class="pre">endpoint=False</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">num</span></code></p></td>
<td><p>The number of points to generate (default = 50).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">endpoint</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the <code class="docutils literal notranslate"><span class="pre">stop</span></code> value is included in the sequence. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the <code class="docutils literal notranslate"><span class="pre">stop</span></code> value is excluded.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">retstep</span></code></p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, returns the spacing (step size) between values in addition to the array.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p>The desired NumPy data type for the output array.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># np.linspace(): 5 evenly spaced numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;linspace:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># Output: [ 1.  3.25  5.5  7.75 10. ]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>linspace: [ 1.    3.25  5.5   7.75 10.  ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-arange">
<h3>np.arange()<a class="headerlink" href="#np-arange" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>gives evenly spaced value over a range with control of step size and data value.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start</span></code></p></td>
<td><p>The starting value (inclusive). Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code> if not provided.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">stop</span></code></p></td>
<td><p>The ending value (<strong>exclusive</strong> by default).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">step</span></code></p></td>
<td><p>The increment (default = <code class="docutils literal notranslate"><span class="pre">1</span></code>). Controls how the sequence progresses.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p>The data type of the output array. If not specified, NumPy infers it automatically.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># np.arange(): Step size of 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arange:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  
<span class="c1"># Output: [1 3 5 7 9]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>arange: [1 3 5 7 9]
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparison-np-arange-vs-np-linspace">
<h3>Comparison: np.arange() vs. np.linspace()<a class="headerlink" href="#comparison-np-arange-vs-np-linspace" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">np.arange()</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Step Control</p></td>
<td><p>Uses a <strong>fixed step</strong> between values.</p></td>
<td><p>Uses a <strong>fixed number of points</strong> between <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>Stop Inclusion</p></td>
<td><p><strong>Exclusive</strong> (default behavior).</p></td>
<td><p><strong>Inclusive</strong> (by default), unless <code class="docutils literal notranslate"><span class="pre">endpoint=False</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>Flexibility</p></td>
<td><p>Good for <strong>integer-based</strong> sequences with regular spacing.</p></td>
<td><p>Better for <strong>floating-point</strong> sequences with exact spacing.</p></td>
</tr>
<tr class="row-odd"><td><p>Use Case</p></td>
<td><p>When you <strong>know the step size</strong> and want values to progress by that amount.</p></td>
<td><p>When you <strong>know the number of points</strong> and want them distributed evenly.</p></td>
</tr>
<tr class="row-even"><td><p>Example</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.arange(1,</span> <span class="pre">10,</span> <span class="pre">2)</span></code> → <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">9]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.linspace(1,</span> <span class="pre">10,</span> <span class="pre">num=5)</span></code> → <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">1.</span>&#160; <span class="pre">3.25</span>&#160; <span class="pre">5.5</span>&#160; <span class="pre">7.75</span> <span class="pre">10.</span> <span class="pre">]</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># np.arange(): Step size of 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arange:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  
<span class="c1"># Output: [1 3 5 7 9]</span>

<span class="c1"># np.linspace(): 5 evenly spaced numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;linspace:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># Output: [ 1.  3.25  5.5  7.75 10. ]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>arange: [1 3 5 7 9]
linspace: [ 1.    3.25  5.5   7.75 10.  ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-zeros">
<h3>np.zeros()<a class="headerlink" href="#np-zeros" title="Link to this heading">#</a></h3>
<p>This function allows you to quickly create an array filled with zeros,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[0., 0.],
        [0., 0.],
        [0., 0.]],

       [[0., 0.],
        [0., 0.],
        [0., 0.]],

       [[0., 0.],
        [0., 0.],
        [0., 0.]],

       [[0., 0.],
        [0., 0.],
        [0., 0.]]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-ones">
<h3>np.ones()<a class="headerlink" href="#np-ones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="array-indexing-introduction">
<h2>4.2: Array Indexing (Introduction)<a class="headerlink" href="#array-indexing-introduction" title="Link to this heading">#</a></h2>
<p>Indexing goes along the axes from zero to “n” for an “n” dimensional array. So a 3D array would be sheet, column, row. Let’s create a 3D NumPy array representing absorbance values at different wavelengths over time for multiple experiments.</p>
<ul class="simple">
<li><p><strong>Axis 0</strong> → Experiment number</p></li>
<li><p><strong>Axis 1</strong> → Sample Times</p></li>
<li><p><strong>Axis 2</strong> → Wavelengths</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a 3D array: 2 experiments, 4 sample times, 3 wavelengths</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">]],</span>  <span class="c1"># Experiment 1</span>
    <span class="p">[[</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">]]</span>   <span class="c1"># Experiment 2</span>
<span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of the array:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 4, 3)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the array: (2, 4, 3)
[[[0.12 0.15 0.18]
  [0.14 0.17 0.2 ]
  [0.16 0.19 0.22]
  [0.18 0.21 0.24]]

 [[0.22 0.25 0.28]
  [0.24 0.27 0.3 ]
  [0.26 0.29 0.32]
  [0.28 0.31 0.34]]]
</pre></div>
</div>
</div>
</div>
<p>This array has:</p>
<ul class="simple">
<li><p>2 experiments (Axis 0)</p></li>
<li><p>4 time steps (Axis 1)</p></li>
<li><p>3 wavelengths (Axis 2)</p></li>
</ul>
<section id="extracting-a-single-value">
<h3>Extracting a Single Value<a class="headerlink" href="#extracting-a-single-value" title="Link to this heading">#</a></h3>
<p>To get a single absorbance value for Experiment 2, sample time 3, Wavelength 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Experiment 2 (index 1), Time step 3 (index 2), Wavelength 2 (index 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absorbance value:&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Absorbance value: 0.29
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-a-1d-array">
<h3>Extract a 1D array<a class="headerlink" href="#extract-a-1d-array" title="Link to this heading">#</a></h3>
<p>Obtain all absorbances for the first experiment at the second time step</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_2_exp_1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_2_exp_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.14 0.17 0.2 ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-a-2d-array">
<h3>Extract a 2D array<a class="headerlink" href="#extract-a-2d-array" title="Link to this heading">#</a></h3>
<p>Obtain absorbance values at third wavelength for all experiments and all sample times</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength_3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wavelength_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.18 0.2  0.22 0.24]
 [0.28 0.3  0.32 0.34]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="slice-out-the-first-experiment">
<h3>Slice out the first experiment<a class="headerlink" href="#slice-out-the-first-experiment" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 4, 3)
[[[0.12 0.15 0.18]
  [0.14 0.17 0.2 ]
  [0.16 0.19 0.22]
  [0.18 0.21 0.24]]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="slice-out-all-data-for-second-and-third-sample-times">
<h3>Slice out all data for second and third sample times<a class="headerlink" href="#slice-out-all-data-for-second-and-third-sample-times" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2, 3)
[[[0.14 0.17 0.2 ]
  [0.16 0.19 0.22]]

 [[0.24 0.27 0.3 ]
  [0.26 0.29 0.32]]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary-table">
<h3>Summary Table<a class="headerlink" href="#summary-table" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Output Shape</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Single Value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[1,</span> <span class="pre">2,</span> <span class="pre">1]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">()</span></code> (Scalar)</p></td>
</tr>
<tr class="row-odd"><td><p>1D Time Slice</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[0,</span> <span class="pre">1,</span> <span class="pre">:]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(3,)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Wavelength 3 Absorbance</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[:,</span> <span class="pre">:,</span> <span class="pre">2]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">4)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>First Experiment</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[0:1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">4,</span> <span class="pre">3)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Time Steps 2-3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[:,</span> <span class="pre">1:3,</span> <span class="pre">:]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">3)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Every Other Wavelength</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data[:,</span> <span class="pre">:,</span> <span class="pre">::2]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">4,</span> <span class="pre">2)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="array-attributes">
<h2>4.3: Array Attributes<a class="headerlink" href="#array-attributes" title="Link to this heading">#</a></h2>
<section id="shape">
<h3>.shape<a class="headerlink" href="#shape" title="Link to this heading">#</a></h3>
<p>Gives the shape of the array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">my_array</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 3, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="ndim">
<h3>.ndim<a class="headerlink" href="#ndim" title="Link to this heading">#</a></h3>
<p>Gives the number of dimensions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
</section>
<section id="size">
<h3>.size<a class="headerlink" href="#size" title="Link to this heading">#</a></h3>
<p>Gives total number of elements in an array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="arrays-from-functions-np-fromfunction">
<h2>4.4: Arrays from Functions (np.fromfunction())<a class="headerlink" href="#arrays-from-functions-np-fromfunction" title="Link to this heading">#</a></h2>
<p>You can make an array from a function, let’s create an array for the molar mass of 1-10 elements of carbon, oxygen and hydrogen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="k">def</span><span class="w"> </span><span class="nf">molar_mass_grid</span><span class="p">(</span><span class="n">element_idx</span><span class="p">,</span> <span class="n">atom_count</span><span class="p">):</span>
    <span class="c1"># Atomic masses: C=12.01, H=1.008, O=16.00</span>
    <span class="n">atomic_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.01</span><span class="p">,</span> <span class="mf">1.008</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">])</span>  
    <span class="k">return</span> <span class="n">atomic_masses</span><span class="p">[</span><span class="n">element_idx</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">*</span> <span class="p">(</span><span class="n">atom_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">mass_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span><span class="n">molar_mass_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 12.01   24.02   36.03   48.04   60.05   72.06   84.07   96.08  108.09
  120.1  ]
 [  1.008   2.016   3.024   4.032   5.04    6.048   7.056   8.064   9.072
   10.08 ]
 [ 16.     32.     48.     64.     80.     96.    112.    128.    144.
  160.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Step 1: Define the mass grid using np.fromfunction()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">molecular_mass_grid</span><span class="p">(</span><span class="n">element_idx</span><span class="p">,</span> <span class="n">atom_count</span><span class="p">):</span>
    <span class="n">atomic_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.01</span><span class="p">,</span> <span class="mf">1.008</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">])</span>  <span class="c1"># C, H, O</span>
    <span class="k">return</span> <span class="n">atomic_masses</span><span class="p">[</span><span class="n">element_idx</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">*</span> <span class="p">(</span><span class="n">atom_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">mass_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span><span class="n">molecular_mass_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Step 2: Define a function to compute molar mass</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_molar_mass</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
    <span class="c1"># Define mapping for element index lookup</span>
    <span class="n">element_indices</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
    
    <span class="c1"># Parse formula into element counts</span>
    <span class="n">parsed_formula</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>  <span class="c1"># Example: C3H8O</span>

    <span class="c1"># Step 3: Compute molar mass</span>
    <span class="c1">#molar_mass = sum(mass_grid[element_indices[element], atoms - 1] for element, atoms in parsed_formula)</span>
    <span class="n">molar_mass</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Initialize molar mass</span>
    <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">parsed_formula</span><span class="p">:</span>
        <span class="n">element_idx</span> <span class="o">=</span> <span class="n">element_indices</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>  <span class="c1"># Get index for the element</span>
        <span class="n">molar_mass</span> <span class="o">+=</span> <span class="n">mass_grid</span><span class="p">[</span><span class="n">element_idx</span><span class="p">,</span> <span class="n">atoms</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Accumulate mass using array indexing</span>
        
    <span class="k">return</span> <span class="n">molar_mass</span>

<span class="c1"># Step 4: Compute molar mass of C3H8O (Propanol)</span>
<span class="n">molar_mass_C3H8O</span> <span class="o">=</span> <span class="n">compute_molar_mass</span><span class="p">(</span><span class="s2">&quot;C3H8O&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Molar Mass of C3H8O: </span><span class="si">{</span><span class="n">molar_mass_C3H8O</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> g/mol&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Molar Mass of C3H8O: 60.09 g/mol
</pre></div>
</div>
</div>
</div>
</section>
<section id="sorting-arrays">
<h2>4.5: Sorting Arrays<a class="headerlink" href="#sorting-arrays" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>axis=0: Sort along columns (vertically)</p></li>
<li><p>axis=1: Sort along rows (horizontally)</p></li>
<li><p>axis=-1: Sort along the last axis (default)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original array: </span><span class="se">\n</span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># Sort each column</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sort axis 0 </span><span class="se">\n</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Sort each row</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sort axis 1 </span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original array: 
[[3 1 4]
 [1 5 9]
 [2 6 5]]

sort axis 0 
[[1 1 4]
 [2 5 5]
 [3 6 9]]

sort axis 1 
 [[1 3 4]
 [1 5 9]
 [2 5 6]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="reshaping-arrays">
<h2>4.6 Reshaping Arrays<a class="headerlink" href="#reshaping-arrays" title="Link to this heading">#</a></h2>
<section id="reshape">
<h3>.reshape()<a class="headerlink" href="#reshape" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The number of elements of the original and reshaped arrays must be the same</p></li>
<li><p>(3,2,4) array must be a multiple of the product of the indices</p></li>
<li><p>In the following we have measurements at 5 wavelengths taken 3 different times</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulated absorbance data (1D)</span>
<span class="n">absorbance_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># Example: 15 absorbance values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">absorbance_data</span><span class="p">)</span>
<span class="c1"># Reshape into 3 time points × 5 wavelengths</span>
<span class="n">absorbance_matrix</span> <span class="o">=</span> <span class="n">absorbance_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">absorbance_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
[[ 0  1  2  3  4]
 [ 5  6  7  8  9]
 [10 11 12 13 14]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="flatten">
<h3>.flatten()<a class="headerlink" href="#flatten" title="Link to this heading">#</a></h3>
<p>-convert multi-dimensional array to a 1D array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">absorbance_matrix</span><span class="p">)</span>
<span class="n">flat_matrix</span><span class="o">=</span><span class="n">absorbance_matrix</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flat_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0  1  2  3  4]
 [ 5  6  7  8  9]
 [10 11 12 13 14]]
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
</pre></div>
</div>
</div>
</div>
</section>
<section id="transpose-arrays">
<h3>Transpose Arrays<a class="headerlink" href="#transpose-arrays" title="Link to this heading">#</a></h3>
<p>Transposing a matrix swaps columns and rows.  For dimensions higher than 2 you have two choices, <code class="docutils literal notranslate"><span class="pre">.T</span></code> and <code class="docutils literal notranslate"><span class="pre">.transpose()</span></code>.  The former does a full transpose and completely rearranges the order, while the latter allows you to specify axes transposed
<code class="docutils literal notranslate"><span class="pre">.T</span></code> vs. <code class="docutils literal notranslate"><span class="pre">.transpose()</span></code>: Key Differences</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">.T</span></code> (Shortcut)</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">.transpose()</span></code> (Flexible)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Works on 2D?</p></td>
<td><p>Yes (swaps rows &amp; columns)</p></td>
<td><p>Yes (same as <code class="docutils literal notranslate"><span class="pre">.T</span></code> for 2D)</p></td>
</tr>
<tr class="row-odd"><td><p>Works on 3D+?</p></td>
<td><p>Yes (reverses all axes)</p></td>
<td><p>Yes (custom axis order)</p></td>
</tr>
<tr class="row-even"><td><p>Custom Axis Order?</p></td>
<td><p>No</p></td>
<td><p>Yes (<code class="docutils literal notranslate"><span class="pre">.transpose(axes)</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>Effect on (2,3,4) Shape?</p></td>
<td><p>➝ <code class="docutils literal notranslate"><span class="pre">(4,3,2)</span></code> (full reverse)</p></td>
<td><p>➝ Custom order (e.g., <code class="docutils literal notranslate"><span class="pre">(3,4,2)</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<section id="t-full-transpose">
<h4>.T (Full Transpose)<a class="headerlink" href="#t-full-transpose" title="Link to this heading">#</a></h4>
<p>Full transpose</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_array</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">transposed array </span><span class="se">\n</span><span class="si">{</span><span class="n">my_array</span><span class="o">.</span><span class="n">T</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]
 [13 14 15 16]
 [17 18 19 20]
 [21 22 23 24]]

transposed array 
[[ 1  5  9 13 17 21]
 [ 2  6 10 14 18 22]
 [ 3  7 11 15 19 23]
 [ 4  8 12 16 20 24]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="transpose">
<h4>.transpose()<a class="headerlink" href="#transpose" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_array</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;transposing rows (3) and columns(1) of 3D array </span><span class="se">\n</span><span class="si">{</span><span class="n">my_array</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[ 1  2  3  4]
  [ 5  6  7  8]
  [ 9 10 11 12]]

 [[13 14 15 16]
  [17 18 19 20]
  [21 22 23 24]]]
transposing rows (3) and columns(1) of 3D array 
[[[ 1  5  9]
  [ 2  6 10]
  [ 3  7 11]
  [ 4  8 12]]

 [[13 17 21]
  [14 18 22]
  [15 19 23]
  [16 20 24]]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="scenario-kinetic-absorbance-data-for-a-chemical-reaction">
<h4>Scenario: Kinetic Absorbance Data for a Chemical Reaction<a class="headerlink" href="#scenario-kinetic-absorbance-data-for-a-chemical-reaction" title="Link to this heading">#</a></h4>
<p>A spectrometer records absorbance at multiple wavelengths over several time points across different experiments (e.g., varying reagent concentrations).<br />
This dataset is stored in a <strong>3D NumPy array</strong> where:</p>
<ul class="simple">
<li><p>Axis 0 → 3 different experiments (e.g., different NaOH concentrations).</p></li>
<li><p>Axis 1 → 4 different time points (e.g., 0s, 10s, 20s…).</p></li>
<li><p>Axis 2 → 5 different wavelengths (e.g., 400 nm, 450 nm, 500 nm…).</p></li>
</ul>
<p>Goal: The chemist needs to rearrange the dataset to focus on a wavelength-first structure, where:</p>
<ul class="simple">
<li><p>Axis 0 → Wavelengths</p></li>
<li><p>Axis 1 → Experiments</p></li>
<li><p>Axis 2 → Time points</p></li>
</ul>
<p>This makes it easier to <strong>extract and compare spectral changes at specific wavelengths</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Set the seed for reproducibility</span>

<span class="c1"># Simulated absorbance data: (Experiments, Time Points, Wavelengths)</span>
<span class="n">absorbance_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Shape (3, 4, 5)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Shape:&quot;</span><span class="p">,</span> <span class="n">absorbance_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,4,5)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">absorbance_data</span><span class="p">)</span>  <span class="c1"># Will always generate the same random values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Shape: (3, 4, 5)
[[[0.37454012 0.95071431 0.73199394 0.59865848 0.15601864]
  [0.15599452 0.05808361 0.86617615 0.60111501 0.70807258]
  [0.02058449 0.96990985 0.83244264 0.21233911 0.18182497]
  [0.18340451 0.30424224 0.52475643 0.43194502 0.29122914]]

 [[0.61185289 0.13949386 0.29214465 0.36636184 0.45606998]
  [0.78517596 0.19967378 0.51423444 0.59241457 0.04645041]
  [0.60754485 0.17052412 0.06505159 0.94888554 0.96563203]
  [0.80839735 0.30461377 0.09767211 0.68423303 0.44015249]]

 [[0.12203823 0.49517691 0.03438852 0.9093204  0.25877998]
  [0.66252228 0.31171108 0.52006802 0.54671028 0.18485446]
  [0.96958463 0.77513282 0.93949894 0.89482735 0.59789998]
  [0.92187424 0.0884925  0.19598286 0.04522729 0.32533033]]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose: (Experiments, Time Points, Wavelengths) → (Wavelengths, Experiments, Time Points)</span>
<span class="n">transposed_data</span> <span class="o">=</span> <span class="n">absorbance_data</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Shape:&quot;</span><span class="p">,</span> <span class="n">transposed_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected output: (5, 3, 4)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transposed_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>New Shape: (5, 3, 4)
[[[0.37454012 0.15599452 0.02058449 0.18340451]
  [0.61185289 0.78517596 0.60754485 0.80839735]
  [0.12203823 0.66252228 0.96958463 0.92187424]]

 [[0.95071431 0.05808361 0.96990985 0.30424224]
  [0.13949386 0.19967378 0.17052412 0.30461377]
  [0.49517691 0.31171108 0.77513282 0.0884925 ]]

 [[0.73199394 0.86617615 0.83244264 0.52475643]
  [0.29214465 0.51423444 0.06505159 0.09767211]
  [0.03438852 0.52006802 0.93949894 0.19598286]]

 [[0.59865848 0.60111501 0.21233911 0.43194502]
  [0.36636184 0.59241457 0.94888554 0.68423303]
  [0.9093204  0.54671028 0.89482735 0.04522729]]

 [[0.15601864 0.70807258 0.18182497 0.29122914]
  [0.45606998 0.04645041 0.96563203 0.44015249]
  [0.25877998 0.18485446 0.59789998 0.32533033]]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="merging-arrays">
<h2>4.7: Merging Arrays<a class="headerlink" href="#merging-arrays" title="Link to this heading">#</a></h2>
<p>Functions like np.concatenate(), np.vstack(), np.hstack(), and np.dstack() always create a new array. They do not modify the original arrays but instead return a new one that needs to be saved to a variable.</p>
<section id="np-vstack">
<h3>np.vstack()<a class="headerlink" href="#np-vstack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Adds arrays as <strong>new rows</strong> (along axis 0).</p></li>
<li><p>Requires <strong>matching number of columns</strong>.</p></li>
</ul>
<p>Example: Combining Molecular Property Data
Imagine we have two datasets:</p>
<ul class="simple">
<li><p><strong>Dataset 1</strong>: Molar masses of three molecules.</p></li>
<li><p><strong>Dataset 2</strong>: Molar masses of three other molecules</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Molecular masses (g/mol)</span>
<span class="n">mass_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">18.015</span><span class="p">],</span>  <span class="c1"># Water</span>
                      <span class="p">[</span><span class="mf">44.01</span><span class="p">],</span>   <span class="c1"># CO2</span>
                      <span class="p">[</span><span class="mf">32.00</span><span class="p">]])</span>  <span class="c1"># O2</span>

<span class="c1"># Boiling points (°C)</span>
<span class="n">boiling_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">],</span>  <span class="c1"># Water</span>
                         <span class="p">[</span><span class="o">-</span><span class="mf">78.5</span><span class="p">],</span> <span class="c1"># CO2</span>
                         <span class="p">[</span><span class="o">-</span><span class="mi">183</span><span class="p">]])</span> <span class="c1"># O2</span>

<span class="c1"># Stack them vertically</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">mass_data</span><span class="p">,</span> <span class="n">boiling_data</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Molecular masses (g/mol)</span>
<span class="n">mass1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">18.015</span><span class="p">],</span>  <span class="c1"># Water</span>
                      <span class="p">[</span><span class="mf">44.01</span><span class="p">],</span>   <span class="c1"># CO2</span>
                      <span class="p">[</span><span class="mf">32.00</span><span class="p">]])</span>  <span class="c1"># O2</span>

<span class="c1"># Molecular massess (g/mol)</span>
<span class="n">mass2_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">180.16</span><span class="p">],</span>  <span class="c1"># Aspirin</span>
                         <span class="p">[</span><span class="mf">151.16</span><span class="p">],</span> <span class="c1"># Acetaminophen</span>
                         <span class="p">[</span><span class="mf">206.28</span><span class="p">]])</span> <span class="c1"># Ibuprofen</span>

<span class="c1"># Stack them vertically</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">mass1_data</span><span class="p">,</span> <span class="n">mass2_data</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 18.015]
 [ 44.01 ]
 [ 32.   ]
 [180.16 ]
 [151.16 ]
 [206.28 ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-hstack">
<h3>np.hstack()<a class="headerlink" href="#np-hstack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Adds arrays as new columns (along axis 1).</p></li>
<li><p>Requires matching number of rows.</p></li>
</ul>
<p>Example: Combining Molecular Property Data
Imagine we have two datasets:</p>
<ul class="simple">
<li><p>Dataset 1: Molecular masses of three molecules.</p></li>
<li><p>Dataset 2: Their boiling points.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Molecular masses (g/mol)</span>
<span class="n">mass_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">18.015</span><span class="p">],</span>  <span class="c1"># Water</span>
                      <span class="p">[</span><span class="mf">44.01</span><span class="p">],</span>   <span class="c1"># CO2</span>
                      <span class="p">[</span><span class="mf">32.00</span><span class="p">]])</span>  <span class="c1"># O2</span>

<span class="c1"># Boiling points (°C)</span>
<span class="n">boiling_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">],</span>  <span class="c1"># Water</span>
                         <span class="p">[</span><span class="o">-</span><span class="mf">78.5</span><span class="p">],</span> <span class="c1"># CO2</span>
                         <span class="p">[</span><span class="o">-</span><span class="mi">183</span><span class="p">]])</span> <span class="c1"># O2</span>
<span class="c1"># Stack them horizontally</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">mass_data</span><span class="p">,</span> <span class="n">boiling_data</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Molecular masses (g/mol)</span>
<span class="n">mass_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">18.015</span><span class="p">],</span>  <span class="c1"># Water</span>
                      <span class="p">[</span><span class="mf">44.01</span><span class="p">],</span>   <span class="c1"># CO2</span>
                      <span class="p">[</span><span class="mf">32.00</span><span class="p">]])</span>  <span class="c1"># O2</span>

<span class="c1"># Boiling points (°C)</span>
<span class="n">boiling_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">],</span>  <span class="c1"># Water</span>
                         <span class="p">[</span><span class="o">-</span><span class="mf">78.5</span><span class="p">],</span> <span class="c1"># CO2</span>
                         <span class="p">[</span><span class="o">-</span><span class="mi">183</span><span class="p">]])</span> <span class="c1"># O2</span>

<span class="c1"># Stack them horizontally</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">mass_data</span><span class="p">,</span> <span class="n">boiling_data</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[  18.015  100.   ]
 [  44.01   -78.5  ]
 [  32.    -183.   ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-column-stack">
<h3>np.column_stack()<a class="headerlink" href="#np-column-stack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Works like <code class="docutils literal notranslate"><span class="pre">hstack()</span></code>, but is specifically designed for <strong>1D arrays</strong>.</p></li>
</ul>
<p>Example: Pairing Element Symbols with Atomic Weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Element symbols</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="c1"># Atomic masses</span>
<span class="n">atomic_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.008</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">,</span> <span class="mf">12.01</span><span class="p">])</span>

<span class="c1"># Combine into a structured array</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">elements</span><span class="p">,</span> <span class="n">atomic_masses</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;H&#39; &#39;1.008&#39;]
 [&#39;O&#39; &#39;16.0&#39;]
 [&#39;C&#39; &#39;12.01&#39;]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-dstack">
<h3>np.dstack( )<a class="headerlink" href="#np-dstack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>only works on 1 and 2D arrays</p></li>
<li><p>Results in 3d arrays</p></li>
</ul>
<section id="stacking-1d-arrays">
<h4>Stacking 1D arrays<a class="headerlink" href="#stacking-1d-arrays" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># Shape (3,)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>  <span class="c1"># Shape (3,)</span>

<span class="n">stacked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stacked shape:&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (1, 3, 2)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stacked shape: (1, 3, 2)
[[[1 4]
  [2 5]
  [3 6]]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="stacking-2d-arrays">
<h4>Stacking 2D arrays<a class="headerlink" href="#stacking-2d-arrays" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>  <span class="c1"># Shape (2,2)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>  <span class="c1"># Shape (2,2)</span>

<span class="n">stacked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stacked shape:&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 2, 2)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stacked shape: (2, 2, 2)
[[[1 5]
  [2 6]]

 [[3 7]
  [4 8]]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="np-stack">
<h3>np.stack()<a class="headerlink" href="#np-stack" title="Link to this heading">#</a></h3>
<p>For higher order arrays you need np.stack()</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Set the seed for reproducibility</span>

<span class="c1"># Define common wavelength range (same for all experiments)</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5 wavelengths from 400 to 700 nm</span>

<span class="c1"># Define common time scale (to enable stacking)</span>
<span class="n">common_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 6 time points from 0s to 100s</span>

<span class="c1"># Simulate absorbance data (random values for illustration)</span>
<span class="n">exp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of a single experiment dataset:&quot;</span><span class="p">,</span> <span class="n">exp1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (6, 5, 1)</span>
<span class="c1"># Stack experiments along a new axis (creating a 4D array)</span>
<span class="n">spectroscopy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">exp1</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">exp3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of stacked spectroscopy data:&quot;</span><span class="p">,</span> <span class="n">spectroscopy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,6,5,1)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of a single experiment dataset: (6, 5, 1)
Shape of stacked spectroscopy data: (3, 6, 5, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define common wavelength range (same for all experiments)</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5 wavelengths from 400 to 700 nm</span>

<span class="c1"># Define common time scale (to enable stacking)</span>
<span class="n">common_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 6 time points from 0s to 100s</span>

<span class="c1"># Simulate absorbance data (random values for illustration)</span>
<span class="n">exp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>

<span class="c1"># Stack experiments along a new axis (creating a 4D array)</span>
<span class="n">spectroscopy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">exp1</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">exp3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Function to plot absorbance over time for a specific wavelength across all experiments</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_absorbance_at_wavelength</span><span class="p">(</span><span class="n">target_wavelength</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots absorbance vs time for a specific wavelength across all experiments.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    target_wavelength (float): The wavelength to extract absorbance values for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_experiments</span> <span class="o">=</span> <span class="n">spectroscopy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Number of experiments</span>

    <span class="c1"># Find the closest wavelength index in the wavelength array</span>
    <span class="n">wavelength_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">wavelengths</span> <span class="o">-</span> <span class="n">target_wavelength</span><span class="p">))</span>

    <span class="c1"># Define experiment labels for the legend</span>
    <span class="n">experiment_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Experiment </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">)]</span>
    
    <span class="c1"># Set up a color cycle for experiments</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>

    <span class="c1"># Create figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">exp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">):</span>
        <span class="n">absorbance_values</span> <span class="o">=</span> <span class="n">spectroscopy_data</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="n">wavelength_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract absorbance data</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">common_time</span><span class="p">,</span> <span class="n">absorbance_values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">experiment_labels</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absorbance at </span><span class="si">{</span><span class="n">target_wavelength</span><span class="si">}</span><span class="s1"> nm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot absorbance at 620 nm across all experiments</span>
<span class="n">plot_absorbance_at_wavelength</span><span class="p">(</span><span class="mi">620</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/28808e231106b64d44e28ec7c0250f9d6f93426e148861ce6527c0621d85a837.png" src="../../_images/28808e231106b64d44e28ec7c0250f9d6f93426e148861ce6527c0621d85a837.png" />
</div>
</div>
</section>
<section id="np-concatenate">
<h3>np.concatenate()<a class="headerlink" href="#np-concatenate" title="Link to this heading">#</a></h3>
<p>In the above we had three experiments with the dimensions (6,5,1).  We then added a fourth dimension usig np.stack() so that all three experiments are in the same array with the dimensions (3,6,5,1).  We can use np.concatenate() to add a fourth experiment to the fourth dimension, giving a 4D array of shape (4,6,5,1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>


<span class="c1"># Simulate a new experiment (exp4) with the same shape as previous experiments</span>
<span class="n">exp4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>

<span class="c1"># Use np.concatenate() to merge exp4 along axis=0 (experiment axis)</span>
<span class="n">updated_spectroscopy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">spectroscopy_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">exp4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Print the new shape to confirm</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated 4D array shape:&quot;</span><span class="p">,</span> <span class="n">updated_spectroscopy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (4,6,5,1)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Updated 4D array shape: (4, 6, 5, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define common wavelength range (same for all experiments)</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5 wavelengths from 400 to 700 nm</span>

<span class="c1"># Define common time scale (to enable stacking)</span>
<span class="n">common_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 6 time points from 0s to 100s</span>

<span class="c1"># Simulate absorbance data (random values for illustration)</span>
<span class="n">exp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>
<span class="n">exp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>

<span class="c1"># Stack experiments along a new axis (creating a 4D array)</span>
<span class="n">spectroscopy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">exp1</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">exp3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Simulate a new experiment (exp4) with the same shape as previous experiments</span>
<span class="n">exp4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Shape (6,5,1)</span>

<span class="c1"># Use np.concatenate() to merge exp4 along axis=0 (experiment axis)</span>
<span class="n">updated_spectroscopy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">spectroscopy_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">exp4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Function to plot absorbance at different times for all experiments</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_absorbance_at_times</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots absorbance vs wavelength at selected time points for all experiments.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    times_to_plot (list): List of time indices to plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_experiments</span> <span class="o">=</span> <span class="n">updated_spectroscopy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Number of experiments</span>
    
    <span class="c1"># Define experiment labels for the legend</span>
    <span class="n">experiment_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Experiment </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">)]</span>
    
    <span class="c1"># Use the correct Matplotlib colormap approach</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>  <span class="c1"># Updated approach</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">)]</span>  <span class="c1"># Ensures correct color mapping</span>

    <span class="c1"># Create subplots for each selected time point</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">]</span>  <span class="c1"># Ensure axes is iterable for a single plot</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">time_idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">times_to_plot</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">exp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">):</span>
            <span class="n">absorbance_values</span> <span class="o">=</span> <span class="n">updated_spectroscopy_data</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract absorbance data</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">absorbance_values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">experiment_labels</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time = </span><span class="si">{</span><span class="n">common_time</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Example: Plot absorbance at selected time points (Modify as needed)</span>
<span class="n">plot_absorbance_at_times</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>  <span class="c1"># Plot at first, middle, and last time points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7e38459db4d73ca6f9571dce774723872f43bbdb98388aae56675c68acd12803.png" src="../../_images/7e38459db4d73ca6f9571dce774723872f43bbdb98388aae56675c68acd12803.png" />
</div>
</div>
</section>
</section>
<section id="vectorization-and-broadcasting-arrays">
<h2>4.8: Vectorization and Broadcasting Arrays<a class="headerlink" href="#vectorization-and-broadcasting-arrays" title="Link to this heading">#</a></h2>
<section id="vectorization">
<h3>Vectorization<a class="headerlink" href="#vectorization" title="Link to this heading">#</a></h3>
<p>Because of the way arrays are stored in memory you can do operations on every element within an array without having to go through a loop.  If the arrays have identical shapes this is called vectorization, and this is much faster than using loops.</p>
<p>In the following code we have two 1D arrays with 3 elements each, one containing the numbers of carbon, hydrogen and oxygen in a molecule, and the second the molar mass of carbon, hydrogen and oxygen. Two calculate the molar mass we simply multiply the two arrays by each other.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">atomic_weights_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.01</span><span class="p">,</span> <span class="mf">1.008</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">])</span>  <span class="c1"># Order matches elements</span>

<span class="n">mass_matrix</span> <span class="o">=</span> <span class="n">atomic_weights_np</span> <span class="o">*</span> <span class="n">counts</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass_matrix</span><span class="p">)</span>

<span class="n">total_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">atomic_weights_np</span> <span class="o">*</span> <span class="n">counts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">total_mass</span><span class="p">)</span>  <span class="c1"># 180.156 g/mol</span>
</pre></div>
</div>
<p>What happens is</p>
<ul class="simple">
<li><p><strong>Index 0</strong>: 6 * 12.01 = 72.06</p></li>
<li><p><strong>Index 1</strong>: 12 * 1.008</p></li>
<li><p><strong>Index 2</strong>: 6 * 16.00
And this is much faster than looping.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">atomic_weights_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.01</span><span class="p">,</span> <span class="mf">1.008</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">])</span>  <span class="c1"># Order matches elements</span>
<span class="n">mass_matrix</span> <span class="o">=</span> <span class="n">atomic_weights_np</span> <span class="o">*</span> <span class="n">counts</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass_matrix</span><span class="p">)</span>

<span class="n">total_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">atomic_weights_np</span> <span class="o">*</span> <span class="n">counts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">total_mass</span><span class="p">)</span>  <span class="c1"># 180.156 g/mol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[72.06  12.096 96.   ]
180.156
</pre></div>
</div>
</div>
</div>
</section>
<section id="broadcasting">
<h3>Broadcasting<a class="headerlink" href="#broadcasting" title="Link to this heading">#</a></h3>
<p>If the shapes do not match Numpy Broadcasts from the array with the smaller dimensions to the larger by expanding the smaller one to fit the size of the larger.</p>
<section id="scalar-math-on-arrays">
<h4>Scalar math on arrays<a class="headerlink" href="#scalar-math-on-arrays" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{cc} 2 &amp; 4 \\ 6 &amp; 8 \end{array} \right] \times \left[ \begin{array}{c} 2 \end{array} \right]= ?  \end{split}\]</div>
<p>becomes
$<span class="math notranslate nohighlight">\( \left[ \begin{array}{cc} 2 &amp; 4 \\ 6 &amp; 8 \end{array} \right] \times \left[ \begin{array}{cc} 2 &amp; 2 \\ 2 &amp; 2 \end{array} \right]= \left[ \begin{array}{cc} 4 &amp; 8 \\ 12 &amp; 16 \end{array} \right]  \)</span>$</p>
<p><br><br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span> 
<span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 4,  8],
       [12, 16]])
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{cc} 2 &amp; 4 \\ 6 &amp; 8 \end{array} \right] \times \left[ \begin{array}{cc} 4 &amp; 8 \end{array} \right]= ?  \end{split}\]</div>
<p>becomes
$<span class="math notranslate nohighlight">\( \left[ \begin{array}{cc} 2 &amp; 4 \\ 6 &amp; 8 \end{array} \right] \times \left[ \begin{array}{cc} 4 &amp; 8 \\ 4 &amp; 8 \end{array} \right]= \left[ \begin{array}{cc} 8 &amp; 32 \\ 24 &amp; 48 \end{array} \right]  \)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8, 32],
       [24, 64]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="array-io-saving-arrays">
<h2>4.9 Array io (saving arrays)<a class="headerlink" href="#array-io-saving-arrays" title="Link to this heading">#</a></h2>
<p>You can save an array as a binary file (*.npy) or a binary compressed file (*.npz)</p>
<section id="save-load-a-numpy-array">
<h3>Save/Load a NumPy array<a class="headerlink" href="#save-load-a-numpy-array" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;data.npy&quot;</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>  <span class="c1"># Saves as binary file</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;data.npy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loaded_arr</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">sandbox_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/sandbox/&quot;</span><span class="p">)</span>
<span class="n">ndarray_npy_sbpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sandbox_dir</span><span class="p">,</span> <span class="s2">&quot;data.npy&quot;</span><span class="p">)</span>

<span class="c1"># Ensure the ~/sandbox/ directory exists</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sandbox_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">ndarray_npy_sbpath</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>  <span class="c1"># Saves as binary file</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 2. 3.]
 [4. 5. 6.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ndarray_npy_sbpath</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loaded_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 2. 3.]
 [4. 5. 6.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="save-load-multiple-arrays">
<h3>Save/Load multiple arrays<a class="headerlink" href="#save-load-multiple-arrays" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="s2">&quot;data.npz&quot;</span><span class="p">,</span> <span class="n">arr1</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span> <span class="n">arr2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;data.npz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr1&quot;</span><span class="p">])</span>  <span class="c1"># Retrieve first array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr2&quot;</span><span class="p">])</span>  <span class="c1"># Retrieve second array</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">sandbox_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/sandbox/&quot;</span><span class="p">)</span>
<span class="n">ndarray_npz_sbpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sandbox_dir</span><span class="p">,</span> <span class="s2">&quot;data.npz&quot;</span><span class="p">)</span>

<span class="c1"># Ensure the ~/sandbox/ directory exists</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sandbox_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">ndarray_npz_sbpath</span><span class="p">,</span> <span class="n">arr1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">arr2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_files</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ndarray_npz_sbpath</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_files</span><span class="p">[</span><span class="s2">&quot;arr1&quot;</span><span class="p">])</span>  <span class="c1"># Retrieve first array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_files</span><span class="p">[</span><span class="s2">&quot;arr2&quot;</span><span class="p">])</span>  <span class="c1"># Retrieve second array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]
 [13 14 15 16]
 [17 18 19 20]
 [21 22 23 24]]
[0 1 2 3 4 5 6 7 8 9]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="random-number-generation">
<h1>5. Random Number Generation<a class="headerlink" href="#random-number-generation" title="Link to this heading">#</a></h1>
<p>The random submodule allows for a variety of random number generations. It is a very powerful tool for creating datasets to test programs with, and these can be tailored to fit different distributions.</p>
<section id="compare-random-module-with-np-random-submodule">
<h2>Compare Random module with np.random submodule<a class="headerlink" href="#compare-random-module-with-np-random-submodule" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># Define isotopes and their natural abundance</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cl-35&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl-37&quot;</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>  <span class="c1"># Probabilities based on natural abundance</span>

<span class="c1"># Generate 1000 random selections</span>
<span class="n">random_sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Count occurrences</span>
<span class="n">cl_35_count</span> <span class="o">=</span> <span class="n">random_sample</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;Cl-35&quot;</span><span class="p">)</span>
<span class="n">cl_37_count</span> <span class="o">=</span> <span class="n">random_sample</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;Cl-37&quot;</span><span class="p">)</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using random module:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cl-35: </span><span class="si">{</span><span class="n">cl_35_count</span><span class="si">}</span><span class="s2">, Cl-37: </span><span class="si">{</span><span class="n">cl_37_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using random module:
Cl-35: 764, Cl-37: 236
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numpy random Submodule</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define isotopes and their probabilities</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;Cl-35&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl-37&quot;</span><span class="p">])</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>

<span class="c1"># Generate 1000 random selections using NumPy</span>
<span class="n">np_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>

<span class="c1"># Count occurrences using NumPy</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np_sample</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">isotope_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">))</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Using numpy.random:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cl-35: </span><span class="si">{</span><span class="n">isotope_counts</span><span class="p">[</span><span class="s1">&#39;Cl-35&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Cl-37: </span><span class="si">{</span><span class="n">isotope_counts</span><span class="p">[</span><span class="s1">&#39;Cl-37&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using numpy.random:
Cl-35: 749, Cl-37: 251
</pre></div>
</div>
</div>
</div>
<p>Comparing the time we see that the numpy.random.choice is an order of magnitude faster than random.choices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Using random module</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">random_sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;random.choices() time: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Using numpy.random</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">np_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy.random.choice() time: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>random.choices() time: 0.29654 seconds
numpy.random.choice() time: 0.03485 seconds
</pre></div>
</div>
</div>
</div>
<section id="functions-and-methods-in-numpy-random">
<h3>Functions and Methods in <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code><a class="headerlink" href="#functions-and-methods-in-numpy-random" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">random_sample()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Generates random floats uniformly distributed in [0.0, 1.0).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rand()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Generates random values in a given shape from a uniform distribution over [0, 1).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randint()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Returns random integers from a specified range.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">choice()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Randomly selects elements from a given 1D array or list.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uniform()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Generates random floats uniformly distributed between specified low and high values.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normal()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a normal (Gaussian) distribution with specified mean and standard deviation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">standard_normal()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Returns samples from a standard normal distribution (mean=0, std=1).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">seed()</span></code></p></td>
<td><p>Method</p></td>
<td><p>Sets the seed for reproducibility of random number generation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RandomState()</span></code></p></td>
<td><p>Class/Method</p></td>
<td><p>Creates a container for managing random number generation with its own state.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">default_rng()</span></code></p></td>
<td><p>Method</p></td>
<td><p>Returns a new instance of the default random number generator introduced in NumPy 1.17.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">integers()</span></code></p></td>
<td><p>Method</p></td>
<td><p>Generates random integers over a specified range (replacement for <code class="docutils literal notranslate"><span class="pre">randint</span></code> in newer versions).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shuffle()</span></code></p></td>
<td><p>Method</p></td>
<td><p>Shuffles the elements of an array in place.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">permutation()</span></code></p></td>
<td><p>Method</p></td>
<td><p>Returns a permuted sequence or array without modifying the input.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">beta()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a Beta distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">binomial()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a Binomial distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">poisson()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a Poisson distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exponential()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from an exponential distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gamma()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a Gamma distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">geometric()</span></code></p></td>
<td><p>Function</p></td>
<td><p>Draws samples from a geometric distribution.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="np-random-seed">
<h3>np.random.seed()<a class="headerlink" href="#np-random-seed" title="Link to this heading">#</a></h3>
<p>A random.seed allows you to generate the same random values when you rerun the code.</p>
<ul class="simple">
<li><p>Allows reproducible data sets</p></li>
<li><p>Global - affects all subsequent random generation calls within a program unless another seed is set.</p></li>
<li><p>Works with random functions like np.random.rand() and np.random.int()</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Set the seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate 10 random numbers to the hundredth place</span>
<span class="n">random_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_numbers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.37 0.95 0.73 0.6  0.16 0.16 0.06 0.87 0.6  0.71]
</pre></div>
</div>
</div>
</div>
</section>
<section id="np-random-default-rng">
<h3>np.random.default_rng()<a class="headerlink" href="#np-random-default-rng" title="Link to this heading">#</a></h3>
<p>This allows you to create an independent (non global random instance). Note, the second time you call it the numbers are different because you have advanced through the seed iteration, and you need to reset the seed to start over.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># First approach: The RNG advances</span>
<span class="n">rng1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># seed is 42</span>
<span class="n">rng2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span> <span class="c1"># seed is 99</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First call - RNG 1:&quot;</span><span class="p">,</span> <span class="n">rng1</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Advances</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First call - RNG 2:&quot;</span><span class="p">,</span> <span class="n">rng2</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Advances</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second call - RNG 1:&quot;</span><span class="p">,</span> <span class="n">rng1</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Different numbers!</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second call - RNG 2:&quot;</span><span class="p">,</span> <span class="n">rng2</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Different numbers!</span>

<span class="c1"># Reset the generators</span>
<span class="n">rng1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Reinitialize</span>
<span class="n">rng2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>  <span class="c1"># Reinitialize</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reset and first call again - RNG 1:&quot;</span><span class="p">,</span> <span class="n">rng1</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Same as first call!</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reset and first call again - RNG 2:&quot;</span><span class="p">,</span> <span class="n">rng2</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Same as first call!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First call - RNG 1: [0.77395605 0.43887844 0.85859792]
First call - RNG 2: [0.50603067 0.56509163 0.51191596]
Second call - RNG 1: [0.69736803 0.09417735 0.97562235]
Second call - RNG 2: [0.97218637 0.61490314 0.5682835 ]
Reset and first call again - RNG 1: [0.77395605 0.43887844 0.85859792]
Reset and first call again - RNG 2: [0.50603067 0.56509163 0.51191596]
</pre></div>
</div>
</div>
</div>
</section>
<section id="uniform-distribution">
<h3>Uniform Distribution<a class="headerlink" href="#uniform-distribution" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create an independent RNG</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate 1000 random numbers from uniform distribution</span>
<span class="n">uniform_data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>


<span class="c1"># Create a histogram plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot uniform distribution histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">uniform_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;uniform()&quot;</span><span class="p">)</span>



<span class="c1"># Labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of uniform data)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c8e2791815bf2dd15cd3b259ab7b8f78a8c13543821ec14b488122958869e285.png" src="../../_images/c8e2791815bf2dd15cd3b259ab7b8f78a8c13543821ec14b488122958869e285.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create an independent RNG</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate 1000 random numbers from uniform distribution</span>
<span class="n">standard_normal_data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>


<span class="c1"># Create a histogram plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot uniform distribution histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">standard_normal_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;uniform()&quot;</span><span class="p">)</span>



<span class="c1"># Labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of standard normal data)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2c937a38965190514387993f080a0d571fde323a2d509cbafbabc7d42d1bb6e8.png" src="../../_images/2c937a38965190514387993f080a0d571fde323a2d509cbafbabc7d42d1bb6e8.png" />
</div>
</div>
<p>Inserting noise into an equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define wavelengths for R, I, and P</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">450</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">650</span><span class="p">])</span>  <span class="c1"># nm</span>

<span class="c1"># Define common time scale (10 points over 100s)</span>
<span class="n">common_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  

<span class="c1"># Define the number of experiments</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">4</span>  

<span class="c1"># Function to simulate reaction kinetics: R → I → P</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reaction_profiles</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates reaction kinetics:</span>
<span class="sd">    - R (Reactant) decays exponentially.</span>
<span class="sd">    - I (Intermediate) forms, then decays as P forms.</span>
<span class="sd">    - P (Product) forms as I decays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>  <span class="c1"># Exponential decay for R</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">time</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10</span>  <span class="c1"># Intermediate formation &amp; decay</span>
    <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">time</span><span class="p">))</span>  <span class="c1"># Product formation</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">R</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">P</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transpose to match (time, species)</span>

<span class="c1"># Initialize a NumPy array to store absorbance data (4D array)</span>
<span class="c1"># Shape: (Experiments, Time, Wavelengths, 1)</span>
<span class="n">absorbance_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_experiments</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Generate data for each experiment</span>
<span class="k">for</span> <span class="n">exp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">):</span>
    <span class="n">reaction_data</span> <span class="o">=</span> <span class="n">reaction_profiles</span><span class="p">(</span><span class="n">common_time</span><span class="p">)</span>  <span class="c1"># Get kinetic profiles</span>

    <span class="c1"># Introduce slight experimental variations using a random factor</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">reaction_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Small noise added</span>
    <span class="n">absorbance_data</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">reaction_data</span> <span class="o">+</span> <span class="n">noise</span>  <span class="c1"># Store data</span>

<span class="c1"># Function to plot absorbance vs time at selected wavelengths</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_absorbance_at_wavelengths</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots absorbance vs time for selected wavelengths (450nm, 550nm, 650nm),</span>
<span class="sd">    representing Reactant, Intermediate, and Product formation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">experiment_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Experiment </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">)]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">))</span>  <span class="c1"># Assign colors</span>

    <span class="c1"># Create subplots for each wavelength</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">wavelength_idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">))):</span>
        <span class="k">for</span> <span class="n">exp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">):</span>
            <span class="n">absorbance_values</span> <span class="o">=</span> <span class="n">absorbance_data</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="n">wavelength_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract data</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">common_time</span><span class="p">,</span> <span class="n">absorbance_values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">experiment_labels</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absorbance at </span><span class="si">{</span><span class="n">wavelengths</span><span class="p">[</span><span class="n">wavelength_idx</span><span class="p">]</span><span class="si">}</span><span class="s1"> nm&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot absorbance at 450nm, 550nm, and 650nm</span>
<span class="n">plot_absorbance_at_wavelengths</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cd5c0752e3e1d0e5055ad1d8934b578bdb1c847e518fbd272d1a9b14cedb1761.png" src="../../_images/cd5c0752e3e1d0e5055ad1d8934b578bdb1c847e518fbd272d1a9b14cedb1761.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show data of second experiment</span>
<span class="n">absorbance_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 9.87965868e-01,  3.70455637e-02, -2.69944495e-04],
       [ 5.52599202e-01,  6.53954699e-01,  4.01829706e-01],
       [ 3.33370260e-01,  6.92346570e-01,  6.44243291e-01],
       [ 1.92812828e-01,  6.44354674e-01,  8.14551763e-01],
       [ 1.06055058e-01,  4.75613585e-01,  8.62061537e-01],
       [ 4.77796399e-02,  3.36212358e-01,  9.58965921e-01],
       [ 4.25463591e-02,  2.02565819e-01,  9.70807686e-01],
       [ 1.27664301e-02,  1.45657704e-01,  9.91765450e-01],
       [ 3.23636189e-02,  1.23013411e-01,  9.71472021e-01],
       [ 5.53699482e-04,  7.40047386e-02,  1.01277296e+00]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show first four temporal measurements of third experiment</span>
<span class="n">absorbance_data</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.99041652, -0.00371318, -0.0221267 ],
       [ 0.54982929,  0.65375432,  0.45337138],
       [ 0.32775279,  0.75161063,  0.67803973],
       [ 0.17597321,  0.63681325,  0.84188513]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the decay of the first experiment</span>
<span class="n">absorbance_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.00993428e+00, 6.04214018e-01, 3.60777244e-01, 1.99726804e-01,
       1.13207269e-01, 5.09307734e-02, 1.75135118e-02, 1.59525497e-02,
       8.55973967e-04, 1.42519074e-02])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Find the values of the reactant and product when the intermediate is max.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">absorbance_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Find the time index where Intermediate (I) is max for each experiment</span>
<span class="n">max_I_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">absorbance_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># I at index 1 (550 nm)</span>

<span class="c1"># Extract corresponding R (450 nm) and P (650 nm) values</span>
<span class="n">R_at_max_I</span> <span class="o">=</span> <span class="n">absorbance_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">),</span> <span class="n">max_I_indices</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># R at 450nm</span>
<span class="n">P_at_max_I</span> <span class="o">=</span> <span class="n">absorbance_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">),</span> <span class="n">max_I_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># P at 650nm</span>

<span class="c1"># Print results</span>
<span class="k">for</span> <span class="n">exp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_experiments</span><span class="p">):</span>
    <span class="n">time_at_max_I</span> <span class="o">=</span> <span class="n">common_time</span><span class="p">[</span><span class="n">max_I_indices</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experiment </span><span class="si">{</span><span class="n">exp_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Time at max I: </span><span class="si">{</span><span class="n">time_at_max_I</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  R (450nm) at max I: </span><span class="si">{</span><span class="n">R_at_max_I</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  P (650nm) at max I: </span><span class="si">{</span><span class="n">P_at_max_I</span><span class="p">[</span><span class="n">exp_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 10, 3, 1)
Experiment 1:
  Time at max I: 22.22 s
  R (450nm) at max I: 0.361
  P (650nm) at max I: 0.661

Experiment 2:
  Time at max I: 22.22 s
  R (450nm) at max I: 0.333
  P (650nm) at max I: 0.644

Experiment 3:
  Time at max I: 22.22 s
  R (450nm) at max I: 0.328
  P (650nm) at max I: 0.678

Experiment 4:
  Time at max I: 22.22 s
  R (450nm) at max I: 0.335
  P (650nm) at max I: 0.671
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="masks">
<h1>6. Masks<a class="headerlink" href="#masks" title="Link to this heading">#</a></h1>
<p>A <strong>mask</strong> is a way of <strong>filtering data</strong> based on a condition.</p>
<ul class="simple">
<li><p>Instead of looping through a dataset and using <code class="docutils literal notranslate"><span class="pre">if</span></code> statements, we can use a <strong>Boolean mask</strong> to <strong>select specific values efficiently</strong>.</p></li>
</ul>
<p>In <strong>NumPy</strong>, masks are frequently used for filtering arrays.</p>
<section id="nonzero">
<h2>.nonzero()<a class="headerlink" href="#nonzero" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">nonzero()</span></code> returns the indices of elements that are non-zero (or <code class="docutils literal notranslate"><span class="pre">True</span></code> for boolean arrays). For a 1D array, it returns a tuple containing a single array of indices. For multi-dimensional arrays, it returns a tuple of arrays, one for each dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define the array</span>
<span class="n">darray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="c1"># Create a boolean mask where values equal to 8 are True</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">darray</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mask:&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>  <span class="c1"># [False False  True False False  True]</span>

<span class="c1"># Use nonzero() to find indices where mask is True</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nonzero() result:&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>  <span class="c1"># returns a tuple of arrays</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracted indices:&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># extract the first array from the tuple</span>

<span class="c1"># Separate analysis of the types</span>
<span class="n">nonzero_result</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nonzero_result:&quot;</span><span class="p">,</span> <span class="n">nonzero_result</span><span class="p">)</span>  <span class="c1"># (array([2, 5]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type of nonzero_result:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">nonzero_result</span><span class="p">))</span>  <span class="c1"># &lt;class &#39;tuple&#39;&gt;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type of nonzero_result[0]:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">nonzero_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># &lt;class &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mask: [False False  True False False  True]
nonzero() result: (array([2, 5]),)
Extracted indices: [2 5]
nonzero_result: (array([2, 5]),)
type of nonzero_result: &lt;class &#39;tuple&#39;&gt;
type of nonzero_result[0]: &lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>Example: Finding Temperatures Above a Threshold</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Temperature readings in °C</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

<span class="c1"># Mask for temperatures above 25°C</span>
<span class="n">high_temps</span> <span class="o">=</span> <span class="n">temperatures</span> <span class="o">&gt;</span> <span class="mi">25</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">high_temps</span><span class="p">)</span>  <span class="c1"># [False False  True False False  True  True]</span>

<span class="c1"># Use the mask to filter values</span>
<span class="n">filtered_temps</span> <span class="o">=</span> <span class="n">temperatures</span><span class="p">[</span><span class="n">high_temps</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered_temps</span><span class="p">)</span>  <span class="c1"># [30 35 40]</span>
</pre></div>
</div>
<p><strong>Why is this useful?</strong></p>
<ul class="simple">
<li><p>Instead of writing a loop with an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement, we <strong>filter</strong> data in a single operation.</p></li>
<li><p><strong>Faster execution</strong> for large datasets.</p></li>
<li><p>Useful for analyzing <strong>experimental datasets</strong> (e.g., selecting only high-energy molecules).</p></li>
</ul>
<section id="why-numpy-handles-true-boolean-masks">
<h3><strong>Why NumPy Handles True Boolean Masks</strong><a class="headerlink" href="#why-numpy-handles-true-boolean-masks" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Boolean Indexing</strong></p>
<ul>
<li><p>NumPy allows direct indexing using a Boolean array (mask), which is not possible with standard lists.</p></li>
<li><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">&gt;</span> <span class="mi">15</span>  <span class="c1"># [False, False, True, True]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>  <span class="c1"># Output: [20 25]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This <strong>directly filters</strong> elements based on the mask.</p></li>
<li><p>Lists don’t support this; you’d need a list comprehension instead.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Performance Optimization</strong></p>
<ul class="simple">
<li><p>NumPy operates at <strong>C-level speed</strong> under the hood, making Boolean masks much faster than loops or comprehensions in pure Python.</p></li>
</ul>
</li>
<li><p><strong>Logical Operations on Masks</strong></p>
<ul>
<li><p>You can combine conditions efficiently using NumPy’s element-wise operations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span>  <span class="c1"># Using bitwise AND for multiple conditions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Standard lists require multiple loops or conditions inside a comprehension.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Temperature readings in °C</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

<span class="c1"># Mask for temperatures above 25°C</span>
<span class="n">high_temps</span> <span class="o">=</span> <span class="n">temperatures</span> <span class="o">&gt;</span> <span class="mi">25</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">high_temps</span><span class="p">)</span>  <span class="c1"># [False False  True False False  True  True]</span>

<span class="c1"># Use the mask to filter values</span>
<span class="n">filtered_temps</span> <span class="o">=</span> <span class="n">temperatures</span><span class="p">[</span><span class="n">high_temps</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered_temps</span><span class="p">)</span>  <span class="c1"># [30 35 40]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[False False  True False False  True  True]
[30 35 40]
</pre></div>
</div>
</div>
</div>
<p>random mask (the following will print between 0 and 10 values that were generated as true</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atomic_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">random_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># Random 0/1 mask</span>
<span class="n">selected_data</span> <span class="o">=</span> <span class="n">atomic_numbers</span><span class="p">[</span><span class="n">random_mask</span><span class="p">]</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">selected_data</span><span class="p">)</span>  <span class="c1"># Random subset of elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2 4 5 6 7]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="where">
<h2>.where<a class="headerlink" href="#where" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 0 2 0 0 5]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="missing-data">
<h1>8. Missing Data<a class="headerlink" href="#missing-data" title="Link to this heading">#</a></h1>
<section id="ieee-nan-not-a-number">
<h2>IEEE NaN (Not a Number)<a class="headerlink" href="#ieee-nan-not-a-number" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>IEEE standard for floating point arithmetic.</p></li>
<li><p>Represents the absence of a valid numerical value in floating point systems</p></li>
</ul>
</section>
<section id="using-boolean-masks-for-nan">
<h2>Using Boolean Masks for NaN<a class="headerlink" href="#using-boolean-masks-for-nan" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1.  2. nan  4.  5.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nan_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nan_mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[False False  True False False]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nan_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nan_mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ True  True False  True  True]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">~</span></code> is the Bitwise NOT operator and inverts the boolean mask</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">~</span></code> <strong>inverts</strong> the Boolean mask:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> → <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> → <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_no_nan</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_no_nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1. 2. 4. 5.]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="numpy-statistics">
<h1>9. NumPy Statistics<a class="headerlink" href="#numpy-statistics" title="Link to this heading">#</a></h1>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.mean()</span></code></p></td>
<td><p>Calculates the arithmetic mean</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.mean([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.median()</span></code></p></td>
<td><p>Calculates the median (middle value)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.median([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.std()</span></code></p></td>
<td><p>Calculates the standard deviation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.std([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.var()</span></code></p></td>
<td><p>Calculates the variance</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.var([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.min()</span></code></p></td>
<td><p>Finds the minimum value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.min([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.max()</span></code></p></td>
<td><p>Finds the maximum value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.max([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.percentile()</span></code></p></td>
<td><p>Calculates the qth percentile</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.percentile([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5],</span> <span class="pre">50)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.sum()</span></code></p></td>
<td><p>Calculates the sum of all elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.sum([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.prod()</span></code></p></td>
<td><p>Calculates the product of all elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.prod([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.cumsum()</span></code></p></td>
<td><p>Calculates the cumulative sum</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.cumsum([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.cumprod()</span></code></p></td>
<td><p>Calculates the cumulative product</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.cumprod([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.argmin()</span></code></p></td>
<td><p>Returns the index of the minimum value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.argmin([3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.argmax()</span></code></p></td>
<td><p>Returns the index of the maximum value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.argmax([3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.ptp()</span></code></p></td>
<td><p>Range of values (max - min)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.ptp([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5])</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<section id="numpy-nan-statistics">
<h2>10. Numpy NaN Statistics<a class="headerlink" href="#numpy-nan-statistics" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanmax(arr)</span></code></p></td>
<td><p>Maximum value, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmax([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanmin(arr)</span></code></p></td>
<td><p>Minimum value, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmin([1,</span> <span class="pre">np.nan,</span> <span class="pre">3,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanmean(arr)</span></code></p></td>
<td><p>Arithmetic mean, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmean([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanmedian(arr)</span></code></p></td>
<td><p>Median value, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmedian([1,</span> <span class="pre">np.nan,</span> <span class="pre">3,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nansum(arr)</span></code></p></td>
<td><p>Sum of elements, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nansum([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanstd(arr)</span></code></p></td>
<td><p>Standard deviation, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanstd([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanvar(arr)</span></code></p></td>
<td><p>Variance, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanvar([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanprod(arr)</span></code></p></td>
<td><p>Product of elements, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanprod([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nancumsum(arr)</span></code></p></td>
<td><p>Cumulative sum, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nancumsum([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nancumprod(arr)</span></code></p></td>
<td><p>Cumulative product, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nancumprod([1,</span> <span class="pre">2,</span> <span class="pre">np.nan,</span> <span class="pre">4])</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanpercentile(arr,</span> <span class="pre">q)</span></code></p></td>
<td><p>Compute percentiles, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanpercentile([1,</span> <span class="pre">np.nan,</span> <span class="pre">3,</span> <span class="pre">4],</span> <span class="pre">50)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.nanquantile(arr,</span> <span class="pre">q)</span></code></p></td>
<td><p>Compute quantiles, ignoring NaNs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanquantile([1,</span> <span class="pre">np.nan,</span> <span class="pre">3,</span> <span class="pre">4],</span> <span class="pre">0.5)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="other-numpy-datatypes">
<h1>12. Other Numpy DataTypes<a class="headerlink" href="#other-numpy-datatypes" title="Link to this heading">#</a></h1>
<p>besides ndarray there are several other datatypes provided by the numpy package</p>
<section id="structured-arrays-np-array">
<h2>9.1: Structured arrays (np.array)<a class="headerlink" href="#structured-arrays-np-array" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Allows <strong>defining heterogeneous data types</strong> .</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a structured dtype with multiple fields</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;U10&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;charge&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)]</span>

<span class="c1"># Create a structured array with different field types</span>
<span class="n">structured_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;Electron&#39;</span><span class="p">,</span> <span class="mf">9.11e-31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Proton&#39;</span><span class="p">,</span> <span class="mf">1.67e-27</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">structured_arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">structured_arr</span><span class="p">))</span>  <span class="c1"># &lt;class &#39;numpy.ndarray&#39;&gt;</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a structured dtype with multiple fields</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;U10&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;charge&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)]</span>

<span class="c1"># Create a structured array with different field types</span>
<span class="n">structured_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;Electron&#39;</span><span class="p">,</span> <span class="mf">9.11e-31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Proton&#39;</span><span class="p">,</span> <span class="mf">1.67e-27</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">structured_arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">structured_arr</span><span class="p">))</span>  <span class="c1"># &lt;class &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Electron&#39;, 9.11e-31, -1) (&#39;Proton&#39;, 1.67e-27,  1)]
&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<section id="how-are-structured-arrays-different-from-regular-ndarrays">
<h3>How Are Structured Arrays Different from Regular <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s?<a class="headerlink" href="#how-are-structured-arrays-different-from-regular-ndarrays" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Regular <code class="docutils literal notranslate"><span class="pre">ndarray</span></code></p></th>
<th class="head"><p>Structured Array (<code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> with <code class="docutils literal notranslate"><span class="pre">dtype</span></code>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Data Type</p></td>
<td><p>Homogeneous (<code class="docutils literal notranslate"><span class="pre">dtype</span></code> is the same for all elements)</p></td>
<td><p>Heterogeneous (<code class="docutils literal notranslate"><span class="pre">dtype</span></code> varies across fields)</p></td>
</tr>
<tr class="row-odd"><td><p>Row Access</p></td>
<td><p>Indexed by number (<code class="docutils literal notranslate"><span class="pre">arr[i]</span></code>)</p></td>
<td><p>Indexed by number (<code class="docutils literal notranslate"><span class="pre">arr[i]</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>Column Access</p></td>
<td><p>Not supported natively</p></td>
<td><p>Accessed by field names (<code class="docutils literal notranslate"><span class="pre">arr['column']</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>Resemblance to DataFrames?</p></td>
<td><p>No</p></td>
<td><p>Yes (similar to structured tables)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="masked-arrays-np-ma-array">
<h2>9.2: Masked arrays (np.ma.array)<a class="headerlink" href="#masked-arrays-np-ma-array" title="Link to this heading">#</a></h2>
<ul>
<li><p>A subclass of <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> that allows elements to be masked (ignored) in computations.</p></li>
<li><p>Useful for handling missing or invalid data without affecting computations.</p></li>
<li><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># Ignores masked elements</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="record-arrays-np-recarray">
<h2>9.3: Record Arrays (np.recarray)<a class="headerlink" href="#record-arrays-np-recarray" title="Link to this heading">#</a></h2>
<p>A variation of structured arrays with attribute-style access.
Example:
rec = np.rec.array([(‘Hydrogen’, 1.008), (‘Oxygen’, 16.00)], dtype=[(‘element’, ‘U10’), (‘mass’, ‘f4’)])
print(rec.element)  # Access column as an attribute</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading">#</a></h1>
<p>This content was developed with assistance from <a class="reference external" href="https://www.perplexity.ai/">Perplexity AI</a> and <a class="reference external" href="https://chatgpt.com/">Chat GPT</a>. Multiple queries were made during the Fall 2024 and the Spring 2025.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "py4sci"
        },
        kernelOptions: {
            name: "py4sci",
            path: "./content/module3-packages1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'py4sci'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Module 3: Packages</p>
      </div>
    </a>
    <a class="right-next"
       href="03-2-pandas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2. Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. NumPy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-an-array">1.1: Features of an Array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-dimensionality">1.2: Array Dimensionality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#array-axes">Array Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-array-example">4D array Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-properties">1.3 Array Properties</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays-as-a-python-objects">2. Arrays as a Python Objects</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-array-attributes">Table of NumPy Array Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-array-methods">Table of NumPy Array Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-numpy-functions-for-arrays">Table of NumPy Functions for Arrays</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#array-data-types">3. Array Data Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dtype">dtype()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#astype-changing-dtypes">.astype() -changing dtypes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-array-tasks">4. Basic Array Tasks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-arrays">4.1: Creating Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#array-constructor-np-array">Array constructor (np.array())</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-array">1D array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2D array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3D array</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-linespace">np.linespace()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-arange">np.arange()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-np-arange-vs-np-linspace">Comparison: np.arange() vs. np.linspace()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-zeros">np.zeros()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-ones">np.ones()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-indexing-introduction">4.2: Array Indexing (Introduction)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-a-single-value">Extracting a Single Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-1d-array">Extract a 1D array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-2d-array">Extract a 2D array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slice-out-the-first-experiment">Slice out the first experiment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slice-out-all-data-for-second-and-third-sample-times">Slice out all data for second and third sample times</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table">Summary Table</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-attributes">4.3: Array Attributes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shape">.shape</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ndim">.ndim</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#size">.size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays-from-functions-np-fromfunction">4.4: Arrays from Functions (np.fromfunction())</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-arrays">4.5: Sorting Arrays</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-arrays">4.6 Reshaping Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape">.reshape()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flatten">.flatten()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose-arrays">Transpose Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-full-transpose">.T (Full Transpose)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose">.transpose()</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-kinetic-absorbance-data-for-a-chemical-reaction">Scenario: Kinetic Absorbance Data for a Chemical Reaction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-arrays">4.7: Merging Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-vstack">np.vstack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-hstack">np.hstack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-column-stack">np.column_stack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-dstack">np.dstack( )</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-1d-arrays">Stacking 1D arrays</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-2d-arrays">Stacking 2D arrays</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-stack">np.stack()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-concatenate">np.concatenate()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization-and-broadcasting-arrays">4.8: Vectorization and Broadcasting Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization">Vectorization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-math-on-arrays">Scalar math on arrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-io-saving-arrays">4.9 Array io (saving arrays)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-load-a-numpy-array">Save/Load a NumPy array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-load-multiple-arrays">Save/Load multiple arrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-number-generation">5. Random Number Generation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-random-module-with-np-random-submodule">Compare Random module with np.random submodule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-and-methods-in-numpy-random">Functions and Methods in <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-random-seed">np.random.seed()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#np-random-default-rng">np.random.default_rng()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uniform-distribution">Uniform Distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">6. Masks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonzero">.nonzero()</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-numpy-handles-true-boolean-masks"><strong>Why NumPy Handles True Boolean Masks</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where">.where</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data">8. Missing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ieee-nan-not-a-number">IEEE NaN (Not a Number)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-boolean-masks-for-nan">Using Boolean Masks for NaN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-statistics">9. NumPy Statistics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-nan-statistics">10. Numpy NaN Statistics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#other-numpy-datatypes">12. Other Numpy DataTypes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-arrays-np-array">9.1: Structured arrays (np.array)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-are-structured-arrays-different-from-regular-ndarrays">How Are Structured Arrays Different from Regular <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#masked-arrays-np-ma-array">9.2: Masked arrays (np.ma.array)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#record-arrays-np-recarray">9.3: Record Arrays (np.recarray)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert Belford
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>